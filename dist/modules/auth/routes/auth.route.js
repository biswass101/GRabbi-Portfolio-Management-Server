"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.authRoutes = void 0;
const express_1 = require("express");
const AuthController_1 = require("../controllers/AuthController");
const validateDTO_1 = require("../../../shared/utils/validateDTO");
const SigninUserDTO_1 = require("../dtos/SigninUserDTO");
const SignupUserDTO_1 = require("../dtos/SignupUserDTO");
const ChangeUserPasswordDTO_1 = require("../dtos/ChangeUserPasswordDTO");
const jwt_1 = require("../../../core/utils/jwt");
const AuthGuard_1 = require("../../../core/guards/AuthGuard");
const env_config_1 = require("../../../config/env.config");
const router = (0, express_1.Router)();
exports.authRoutes = router;
const authController = new AuthController_1.AuthController();
const jwtService = new jwt_1.JwtService({ secret: env_config_1.config.jwt.secret, expiresIn: env_config_1.config.jwt.expiresIn });
const authGuard = new AuthGuard_1.AuthGuard(jwtService);
router.post('/signin', (0, validateDTO_1.validateDTO)(SigninUserDTO_1.SigninUserDTO), authController.signinUser.bind(authController));
router.post('/signup', (0, validateDTO_1.validateDTO)(SignupUserDTO_1.SignupUserDTO), authController.signupUser.bind(authController));
router.post('/change-password', (0, validateDTO_1.validateDTO)(ChangeUserPasswordDTO_1.ChangeUserPasswordDTO), authGuard.handle.bind(authGuard), authController.changePassword.bind(authController));
router.post('/refresh-token', authController.refreshToken.bind(authController));
router.patch('/forget-password', authController.forgetPassword.bind(authController));
router.post('/reset-password', authController.resetPassword.bind(authController));
router.post('/logout', authController.logoutUser.bind(authController));
